language: rust
before_install:
- rustup target add x86_64-unknown-linux-musl
- rustup target add i686-unknown-linux-musl
- rustup target add x86_64-apple-darwin
addons:
  apt:
    packages: musl-tools xz-utils
matrix:
  include:
  - os: linux
    rust: stable
    env: TARGET=x86_64-unknown-linux-musl
  - os: linux
    rust: stable
    env: TARGET=i686-unknown-linux-musl
  - os: osx
    rust: stable
    env: TARGET=x86_64-apple-darwin
script: cargo test --target "$TARGET"
deploy:
  cleanup: true
  provider: cargo
  edge: true
  on:
    tags: true
  token:
    secure: KQMFNlxtGA/EnoOnP6/rjv7WK7eY5Hx3acW/BpPqlIJi3T1z4AMtUgN3TyERgB+YtnteiU1KeMXWbWF0jGtp4XDkYx1MjQKCwAn3PaUUigah5uVDpNWa/1x6AKPAw2/hUxh0JtjbaW51wtlf8D/XmsM16In8rJUAVu97hlKaBIYGwVLYi1MMjLAaKuE0hnLuyxR5BLE+oRyRoCsVBFOHl/i41IMArCkAeG8DiSlvmSnt0ambUELil4kWX6WeHKQyOcYusaSH9HUD/FJb76E0q827AARnEX0Lpgg7k0HTM4g0yROqxRPWWZRQniMep8blCYb4xSMYrGpjT57AyLDuQn18hNLoiOXVQLTAxzOgweh59CoNZeEwPv7FShWjM1X+GSMbTm9g6+GKHERE5dGfeDbTEkCEUbfwvoXxm2CJdxSaJCs/Dnch0h1Q2WMmzc279/MDMqm4rGImBkUAhfC53lLzU/sYIjrNsYipiec9e71qqjY4b5qHqcNXhI9D6a1nYFWIC1gSgjrvuMNKVFf0kRns5J13tfbfqg7gh2m315W0jtjEyPlknzdtlHIu7luyTHh4u0CbB3lQ5nPbx58a8W4jVL8vMRfljGFqoCjDjAG5hGDv2/Y87i5GKEJaM4BxyeDh9SHHdsVGcczFGRoAn4by6Iqg4hNjrgNeKtzmN0U=
